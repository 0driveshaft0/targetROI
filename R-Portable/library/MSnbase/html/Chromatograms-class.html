<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Container for multiple Chromatogram objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Chromatograms-class {MSnbase}"><tr><td>Chromatograms-class {MSnbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Container for multiple Chromatogram objects</h2>

<h3>Description</h3>

<p>The <code>Chromatograms</code> class allows to store
<code><a href="Chromatogram-class.html">Chromatogram</a></code> objects in a <code>matrix</code>-like
two-dimensional structure.
</p>
<p><code>Chromatograms</code>: create an instance of class
<code>Chromatograms</code>.
</p>
<p><code>Chromatograms</code> objects can, just like a <code>matrix</code>,
be subsetted using the <code>[</code> method. Single elements, rows or columns
can be replaced using e.g. <code>x[1, 1] &lt;- value</code> where <code>value</code>
has to be a <code>Chromatogram</code> object or a <code>list</code> of such objects.
</p>
<p><code>plot</code>: plots a <code>Chromatograms</code> object. For each row
in the object one plot is created, i.e. all <code><a href="Chromatogram-class.html">Chromatogram</a></code>
objects in the same row are added to the same plot.
</p>
<p><code>phenoData</code>: accesses the phenotypical desccription of the
samples. Returns an <code>AnnotatedDataFrame</code> object.
</p>
<p><code>pData</code>: accesses the phenotypical description of the
samples. Returns a <code>data.frame</code>.
</p>
<p><code>pData&lt;-</code>: replace the phenotype data.
</p>
<p><code>$</code> and <code>$&lt;-</code>: get or replace individual columns of
the object's pheno data.
</p>
<p><code>colnames&lt;-</code>: replace or set the column names of the
<code>Chromatograms</code> object. Does also set the <code>rownames</code> of the
<code>phenoData</code>.
</p>
<p><code>sampleNames</code>: get the sample names.
</p>
<p><code>sampleNames&lt;-</code>: replace or set the sample names of the
<code>Chromatograms</code> object (i.e. the <code>rownames</code> of the pheno data
and <code>colnames</code> of the data matrix.
</p>
<p><code>isEmpty</code>: returns <code>TRUE</code> if the <code>Chromatograms</code>
object or all of its <code>Chromatogram</code> objects is/are empty or contain
only <code>NA</code> intensities.
</p>
<p><code>featureNames</code>: returns the feature names of the
<code>Chromatograms</code> object.
</p>
<p><code>featureNames&lt;-</code>: set the feature names.
</p>
<p><code>featureData</code>: return the feature data.
</p>
<p><code>featureData&lt;-</code>: replace the object's feature data.
</p>
<p><code>fData</code>: return the feature data as a <code>data.frame</code>.
</p>
<p><code>fData&lt;-</code>: replace the object's feature data by passing a
<code>data.frame</code>
</p>
<p><code>fvarLabels</code>: return the feature data variable names (i.e.
column names).
</p>
<p><code>rownames&lt;-</code>: replace the rownames (and featureNames) of
the object.
</p>
<p><code>precursorMz</code>: return the precursor m/z from the chromatograms. The
method returns a <code>matrix</code> with 2 columns (<code>"mzmin"</code> and
<code>"mzmax"</code>) and as many rows as there are rows in the
<code>Chromatograms</code> object. Each row contains the precursor m/z of the
chromatograms in that row. An error is thrown if the chromatograms within one
row have different precursor m/z values.
</p>
<p><code>productMz</code>: return the product m/z from the chromatograms. The
method returns a <code>matrix</code> with 2 columns (<code>"mzmin"</code> and
<code>"mzmax"</code>) and as many rows as there are rows in the
<code>Chromatograms</code> object. Each row contains the product m/z of the
chromatograms in that row. An error is thrown if the chromatograms within one
row have different product m/z values.
</p>
<p><code>mz</code>: returns the m/z for each row of the <code>Chromatograms</code> object
as a two-column <code>matrix</code> (with columns <code>"mzmin"</code> and
<code>"mzmax"</code>).
</p>
<p><code>polarity</code>: returns the polarity of the scans/chromatograms: '1',
'0' or '-1' for positive, negative or unknown polarity.
</p>
<p><code>bin</code> aggregates intensity values of chromatograms in discrete bins
along the retention time axis. By default, individual <code>Chromatogram</code>
objects of one row are binned into the same bins. The function returns a
<code>Chromatograms</code> object with binned chromatograms.
</p>
<p><code>clean</code>: removes 0-intensity data points. Either all of them
(with <code>all = TRUE</code>) or all except those adjacent to non-zero
intensities (<code>all = FALSE</code>; default). See <code><a href="clean-methods.html">clean</a></code>
documentation for more details and examples.
</p>


<h3>Usage</h3>

<pre>
Chromatograms(data, phenoData, featureData, ...)

## S4 method for signature 'Chromatograms'
show(object)

## S4 method for signature 'Chromatograms,ANY,ANY,ANY'
x[i, j, drop = FALSE]

## S4 replacement method for signature 'Chromatograms'
x[i, j] &lt;- value

## S4 method for signature 'Chromatograms,ANY'
plot(x, col = "#00000060", lty = 1,
  type = "l", xlab = "retention time", ylab = "intensity",
  main = NULL, ...)

## S4 method for signature 'Chromatograms'
phenoData(object)

## S4 method for signature 'Chromatograms'
pData(object)

## S4 replacement method for signature 'Chromatograms,data.frame'
pData(object) &lt;- value

## S4 method for signature 'Chromatograms'
x$name

## S4 replacement method for signature 'Chromatograms'
x$name &lt;- value

## S4 replacement method for signature 'Chromatograms'
colnames(x) &lt;- value

## S4 method for signature 'Chromatograms'
sampleNames(object)

## S4 replacement method for signature 'Chromatograms,ANY'
sampleNames(object) &lt;- value

## S4 method for signature 'Chromatograms'
isEmpty(x)

## S4 method for signature 'Chromatograms'
featureNames(object)

## S4 replacement method for signature 'Chromatograms'
featureNames(object) &lt;- value

## S4 method for signature 'Chromatograms'
featureData(object)

## S4 replacement method for signature 'Chromatograms,ANY'
featureData(object) &lt;- value

## S4 method for signature 'Chromatograms'
fData(object)

## S4 replacement method for signature 'Chromatograms,ANY'
fData(object) &lt;- value

## S4 method for signature 'Chromatograms'
fvarLabels(object)

## S4 replacement method for signature 'Chromatograms'
rownames(x) &lt;- value

## S4 method for signature 'Chromatograms'
precursorMz(object)

## S4 method for signature 'Chromatograms'
productMz(object)

## S4 method for signature 'Chromatograms'
mz(object)

## S4 method for signature 'Chromatograms'
polarity(object)

## S4 method for signature 'Chromatograms'
bin(object, binSize = 0.5,
  breaks = numeric(), fun = max)

## S4 method for signature 'Chromatograms'
clean(object, all = FALSE, na.rm = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p>A <code>list</code> of <code><a href="Chromatogram-class.html">Chromatogram</a></code> objects.</p>
</td></tr>
<tr valign="top"><td><code>phenoData</code></td>
<td>
<p>either a <code>data.frame</code>, <code>AnnotatedDataFrame</code> or
<code>AnnotatedDataFrame</code> describing the phenotypical information of the
samples.</p>
</td></tr>
<tr valign="top"><td><code>featureData</code></td>
<td>
<p>either a <code>data.frame</code> or <code>AnnotatedDataFrame</code>
with additional information for each row of chromatograms.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional parameters to be passed to the
<code><a href="../../base/html/matrix.html">matrix</a></code> constructor, such as <code>nrow</code>, <code>ncol</code>
and <code>byrow</code>.</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>a <code>Chromatograms</code> object.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>For all methods: a <code>Chromatograms</code> object.</p>
</td></tr>
<tr valign="top"><td><code>i</code></td>
<td>
<p>For <code>[</code>: <code>numeric</code>, <code>logical</code> or <code>character</code>
defining which row(s) to extract.</p>
</td></tr>
<tr valign="top"><td><code>j</code></td>
<td>
<p>For <code>[</code>: <code>numeric</code>, <code>logical</code> or <code>character</code>
defining which columns(s) to extract.</p>
</td></tr>
<tr valign="top"><td><code>drop</code></td>
<td>
<p>For <code>[</code>: <code>logical(1)</code> whether to drop the
dimensionality of the returned object (if possible). The default is
<code>drop = FALSE</code>, i.e. each subsetting returns a <code>Chromatograms</code>
object (or a <code>Chromatogram</code> object if a single element is
extracted).</p>
</td></tr>
<tr valign="top"><td><code>value</code></td>
<td>
<p>For <code>[&lt;-</code>: the replacement object(s). Can be a <code>list</code>
of <code><a href="Chromatogram-class.html">Chromatogram</a></code> objects or, if length of <code>i</code> and
<code>j</code> are 1, a single <code><a href="Chromatogram-class.html">Chromatogram</a></code> object.
</p>
<p>For <code>pData&lt;-</code>: a <code>data.frame</code> with the number of rows matching
the number of columns of <code>object</code>.
</p>
<p>For <code>colnames</code>: a <code>character</code> with the new column names.</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>For <code>plot</code>: the color to be used for plotting. Either a
vector of length 1 or equal to <code>ncol(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
<p>For <code>plot</code>: the line type (see <code><a href="../../graphics/html/plot.html">plot</a></code>
for more details. Can be either a vector of length 1 or of length equal
to <code>ncol(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>For <code>plot</code>: the type of plot (see
<code><a href="../../graphics/html/plot.html">plot</a></code> for more details. Can be either a vector
of length 1 or of length equal to <code>ncol(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>For <code>plot</code>: the x-axis label.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>For <code>plot</code>: the y-axis label.</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>For <code>plot</code>: the plot title. If not provided the mz range
will be used as plot title.</p>
</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
<p>For <code>$</code>, the name of the pheno data column.</p>
</td></tr>
<tr valign="top"><td><code>binSize</code></td>
<td>
<p>for <code>bin</code>: <code>numeric(1)</code> with the size of the bins
(in seconds).</p>
</td></tr>
<tr valign="top"><td><code>breaks</code></td>
<td>
<p>for <code>bin</code>: <code>numeric</code> defining the bins. Usually not
required as the function calculates the bins automatically based on
<code>binSize</code> and the retention time range of chromatograms in the same
row.</p>
</td></tr>
<tr valign="top"><td><code>fun</code></td>
<td>
<p>for <code>bin</code>: function to be used to aggregate the intensity
values falling within each bin.</p>
</td></tr>
<tr valign="top"><td><code>all</code></td>
<td>
<p>for <code>clean</code>: <code>logical(1)</code> whether all 0 intensities
should be removed (<code>all = TRUE</code>), or whether 0-intensities
adjacent to peaks should be kept (<code>all = FALSE</code>; default).</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p>for <code>clean</code>: <code>logical(1)</code> whether all <code>NA</code>
intensities should be removed prior to clean 0 intensity data points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>Chromatograms</code> class extends the base <code>matrix</code> class
and hence allows to store <code><a href="Chromatogram-class.html">Chromatogram</a></code> objects in a
two-dimensional array. Each row is supposed to contain
<code>Chromatogram</code> objects for one MS data <em>slice</em> with a common
m/z and rt range. Columns contain <code>Chromatogram</code> objects from the
same sample.
</p>
<p><code>plot</code>: if <code>nrow(x) &gt; 1</code> the plot area is split into
<code>nrow(x)</code> sub-plots and the chromatograms of one row are plotted in
each.
</p>


<h3>Value</h3>

<p>For <code>[</code>: the subset of the <code>Chromatograms</code> object. If a
single element is extracted (e.g. if <code>i</code> and <code>j</code> are of length
1) a <code><a href="Chromatogram-class.html">Chromatogram</a></code> object is returned. Otherwise (if
<code>drop = FALSE</code>, the default, is specified) a <code>Chromatograms</code>
object is returned. If <code>drop = TRUE</code> is specified, the method
returns a <code>list</code> of <code>Chromatogram</code> objects.
</p>
<p>For <code>phenoData</code>: an <code>AnnotatedDataFrame</code> representing the
pheno data of the object.
</p>
<p>For <code>pData</code>: a <code>data.frame</code> representing the pheno data of
the object.
</p>
<p>For <code>$</code>: the value of the corresponding column in the pheno data
table of the object.
</p>


<h3>Note</h3>

<p>Subsetting with <code>[</code> will always return a <code>Chromatograms</code>
object (with the exception of extracting a single element)
unless <code>drop = TRUE</code> is specified. This is different from the
default subsetting behaviour of <code>matrix</code>-like objects.
</p>


<h3>Author(s)</h3>

<p>Johannes Rainer
</p>


<h3>See Also</h3>

<p><code><a href="Chromatogram-class.html">Chromatogram</a></code> for the class representing chromatogram
data.
<code><a href="chromatogram-MSnExp-method.html">chromatogram</a></code> for the method to extract a
<code>Chromatograms</code> object from a <code><a href="MSnExp-class.html">MSnExp</a></code> or
<code><a href="OnDiskMSnExp-class.html">OnDiskMSnExp</a></code> object.
<code><a href="readSRMData.html">readSRMData</a></code> for the function to read chromatographic data
of an SRM/MRM experiment.
</p>


<h3>Examples</h3>

<pre>
## Creating some chromatogram objects to put them into a Chromatograms object
ints &lt;- abs(rnorm(25, sd = 200))
ch1 &lt;- Chromatogram(rtime = 1:length(ints), ints)
ints &lt;- abs(rnorm(32, sd = 90))
ch2 &lt;- Chromatogram(rtime = 1:length(ints), ints)
ints &lt;- abs(rnorm(19, sd = 120))
ch3 &lt;- Chromatogram(rtime = 1:length(ints), ints)
ints &lt;- abs(rnorm(21, sd = 40))
ch4 &lt;- Chromatogram(rtime = 1:length(ints), ints)

## Create a Chromatograms object with 2 rows and 2 columns
chrs &lt;- Chromatograms(list(ch1, ch2, ch3, ch4), nrow = 2)
chrs

## Extract the first element from the second column. Extracting a single
## element always returns a Chromatogram object.
chrs[1, 2]

## Extract the second row. Extracting a row or column (i.e. multiple elements
## returns by default a list of Chromatogram objects.
chrs[2, ]

## Extract the second row with drop = FALSE, i.e. return a Chromatograms
## object.
chrs[2, , drop = FALSE]

## Replace the first element.
chrs[1, 1] &lt;- ch3
chrs

## Add a pheno data.
pd &lt;- data.frame(name = c("first sample", "second sample"),
    idx = 1:2)
pData(chrs) &lt;- pd

## Column names correspond to the row names of the pheno data
chrs

## Access a column within the pheno data
chrs$name

## Access the m/z ratio for each row; this will be NA for the present
## object
mz(chrs)

## Create some random Chromatogram objects
ints &lt;- abs(rnorm(123, mean = 200, sd = 32))
ch1 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 231)
ints &lt;- abs(rnorm(122, mean = 250, sd = 43))
ch2 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 231)
ints &lt;- abs(rnorm(125, mean = 590, sd = 120))
ch3 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 542)
ints &lt;- abs(rnorm(124, mean = 1200, sd = 509))
ch4 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 542)

## Combine into a 2x2 Chromatograms object
chrs &lt;- Chromatograms(list(ch1, ch2, ch3, ch4), byrow = TRUE, ncol = 2)

## Plot the second row
plot(chrs[2, , drop = FALSE])

## Plot all chromatograms
plot(chrs, col = c("#ff000080", "#00ff0080"))
</pre>

<hr /><div style="text-align: center;">[Package <em>MSnbase</em> version 2.12.0 <a href="00Index.html">Index</a>]</div>
</body></html>
