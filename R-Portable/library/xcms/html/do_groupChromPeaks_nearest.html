<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Core API function for chromatic peak grouping using a nearest...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for do_groupChromPeaks_nearest {xcms}"><tr><td>do_groupChromPeaks_nearest {xcms}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Core API function for chromatic peak grouping using a nearest
neighbor approach</h2>

<h3>Description</h3>

<p>The <code>do_groupChromPeaks_nearest</code> function groups peaks across samples by
creating a master peak list and assigning corresponding peaks from all
samples to each peak group (i.e. feature). The method is inspired by the
correspondence algorithm of mzMine (Katajamaa 2006).
</p>


<h3>Usage</h3>

<pre>
do_groupChromPeaks_nearest(peaks, sampleGroups, mzVsRtBalance = 10,
  absMz = 0.2, absRt = 15, kNN = 10)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>peaks</code></td>
<td>
<p>A <code>matrix</code> or <code>data.frame</code> with the mz values and
retention times of the identified chromatographic peaks in all samples of an
experiment. Required columns are <code>"mz"</code>, <code>"rt"</code> and
<code>"sample"</code>. The latter should contain <code>numeric</code> values representing
the index of the sample in which the peak was found.</p>
</td></tr>
<tr valign="top"><td><code>sampleGroups</code></td>
<td>
<p>A vector of the same length than samples defining the
sample group assignments (i.e. which samples belong to which sample
group). This parameter is mandatory for the <code>PeakDensityParam</code>
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).</p>
</td></tr>
<tr valign="top"><td><code>mzVsRtBalance</code></td>
<td>
<p><code>numeric(1)</code> representing the factor by which mz
values are multiplied before calculating the (euclician) distance between
two peaks.</p>
</td></tr>
<tr valign="top"><td><code>absMz</code></td>
<td>
<p><code>numeric(1)</code> maximum tolerated distance for mz values.</p>
</td></tr>
<tr valign="top"><td><code>absRt</code></td>
<td>
<p><code>numeric(1)</code> maximum tolerated distance for rt values.</p>
</td></tr>
<tr valign="top"><td><code>kNN</code></td>
<td>
<p><code>numeric(1)</code> representing the number of nearest neighbors
to check.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with elements <code>"featureDefinitions"</code> and
<code>"peakIndex"</code>. <code>"featureDefinitions"</code> is a <code>matrix</code>, each row
representing an (mz-rt) feature (i.e. peak group) with columns:
</p>

<ul>
<li> <p><code>"mzmed"</code>: median of the peaks' apex mz values.
</p>
</li>
<li> <p><code>"mzmin"</code>: smallest mz value of all peaks' apex within the feature.
</p>
</li>
<li> <p><code>"mzmax"</code>:largest mz value of all peaks' apex within the feature.
</p>
</li>
<li> <p><code>"rtmed"</code>: the median of the peaks' retention times.
</p>
</li>
<li> <p><code>"rtmin"</code>: the smallest retention time of the peaks in the feature.
</p>
</li>
<li> <p><code>"rtmax"</code>: the largest retention time of the peaks in the feature.
</p>
</li>
<li> <p><code>"npeaks"</code>: the total number of peaks assigned to the feature.
</p>
</li></ul>

<p><code>"peakIndex"</code> is a <code>list</code> with the indices of all peaks in a feature in the
<code>peaks</code> input matrix.
</p>


<h3>References</h3>

<p>Katajamaa M, Miettinen J, Oresic M: MZmine: Toolbox for
processing and visualization of mass spectrometry based molecular profile
data. Bioinformatics 2006, 22:634-636.
</p>


<h3>See Also</h3>

<p>Other core peak grouping algorithms: <code><a href="do_groupChromPeaks_density.html">do_groupChromPeaks_density</a></code>,
<code><a href="do_groupPeaks_mzClust.html">do_groupPeaks_mzClust</a></code>
</p>

<hr /><div style="text-align: center;">[Package <em>xcms</em> version 3.8.1 <a href="00Index.html">Index</a>]</div>
</body></html>
