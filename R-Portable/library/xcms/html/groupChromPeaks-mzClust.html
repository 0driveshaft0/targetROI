<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: High resolution peak grouping for single spectra samples</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for groupChromPeaks-mzClust {xcms}"><tr><td>groupChromPeaks-mzClust {xcms}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>High resolution peak grouping for single spectra samples</h2>

<h3>Description</h3>

<p>This method performs high resolution correspondence for single spectra
samples.
</p>
<p>The <code>MzClustParam</code> class allows to specify all settings for the peak
grouping based on the <em>mzClust</em> algorithm.
Instances should be created with the <code>MzClustParam</code> constructor.
</p>
<p><code>sampleGroups</code>,<code>sampleGroups&lt;-</code>: getter and setter
for the <code>sampleGroups</code> slot of the object.
</p>
<p><code>ppm</code>,<code>ppm&lt;-</code>: getter and setter for the <code>ppm</code>
slot of the object.
</p>
<p><code>absMz</code>,<code>absMz&lt;-</code>: getter and setter for the
<code>absMz</code> slot of the object.
</p>
<p><code>minFraction</code>,<code>minFraction&lt;-</code>: getter and setter for
the <code>minFraction</code> slot of the object.
</p>
<p><code>minSamples</code>,<code>minSamples&lt;-</code>: getter and setter for the
<code>minSamples</code> slot of the object.
</p>
<p><code>groupChromPeaks,XCMSnExp,MzClustParam</code>: performs high resolution peak
grouping for single spectrum metabolomics data.
</p>


<h3>Usage</h3>

<pre>
MzClustParam(sampleGroups = numeric(), ppm = 20, absMz = 0,
  minFraction = 0.5, minSamples = 1)

## S4 method for signature 'MzClustParam'
show(object)

## S4 method for signature 'MzClustParam'
sampleGroups(object)

## S4 replacement method for signature 'MzClustParam'
sampleGroups(object) &lt;- value

## S4 method for signature 'MzClustParam'
ppm(object)

## S4 replacement method for signature 'MzClustParam'
ppm(object) &lt;- value

## S4 method for signature 'MzClustParam'
absMz(object)

## S4 replacement method for signature 'MzClustParam'
absMz(object) &lt;- value

## S4 method for signature 'MzClustParam'
minFraction(object)

## S4 replacement method for signature 'MzClustParam'
minFraction(object) &lt;- value

## S4 method for signature 'MzClustParam'
minSamples(object)

## S4 replacement method for signature 'MzClustParam'
minSamples(object) &lt;- value

## S4 method for signature 'XCMSnExp,MzClustParam'
groupChromPeaks(object, param,
  msLevel = 1L)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>sampleGroups</code></td>
<td>
<p>A vector of the same length than samples defining the
sample group assignments (i.e. which samples belong to which sample
group). This parameter is mandatory for the <code>PeakDensityParam</code>
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).</p>
</td></tr>
<tr valign="top"><td><code>ppm</code></td>
<td>
<p><code>numeric(1)</code> representing the relative mz error for the
clustering/grouping (in parts per million).</p>
</td></tr>
<tr valign="top"><td><code>absMz</code></td>
<td>
<p><code>numeric(1)</code> representing the absolute mz error for the
clustering.</p>
</td></tr>
<tr valign="top"><td><code>minFraction</code></td>
<td>
<p><code>numeric(1)</code> defining the minimum fraction of samples
in at least one sample group in which the peaks have to be present to be
considered as a peak group (feature).</p>
</td></tr>
<tr valign="top"><td><code>minSamples</code></td>
<td>
<p><code>numeric(1)</code> with the minimum number of samples in at
least one sample group in which the peaks have to be detected to be
considered a peak group (feature).</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>For <code>groupChromPeaks</code>: an <a href="XCMSnExp-class.html">XCMSnExp</a> object containing the
results from a previous chromatographic peak detection analysis (see
<code><a href="chromatographic-peak-detection.html">findChromPeaks()</a></code>).</p>
<pre>For all other methods: a `MzClustParam` object.
</pre></td></tr>
<tr valign="top"><td><code>value</code></td>
<td>
<p>The value for the slot.</p>
</td></tr>
<tr valign="top"><td><code>param</code></td>
<td>
<p>A <code>MzClustParam</code> object containing all settings for
the peak grouping algorithm.</p>
</td></tr>
<tr valign="top"><td><code>msLevel</code></td>
<td>
<p><code>integer(1)</code> defining the MS level. Currently only MS level
1 is supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>MzClustParam</code> function returns a <code>MzClustParam</code> class instance with
all of the settings specified for high resolution single spectra peak
alignment.
</p>
<p>For <code>groupChromPeaks</code>: a <a href="XCMSnExp-class.html">XCMSnExp</a> object with the results of the peak
grouping step (i.e. the features). These can be accessed with the
<code><a href="XCMSnExp-class.html">featureDefinitions()</a></code> method.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.__classVersion__,sampleGroups,ppm,absMz,minFraction,minSamples</code></dt><dd><p>See corresponding parameter above. <code>.__classVersion__</code> stores
the version from the class. Slots values should exclusively be accessed
<em>via</em> the corresponding getter and setter methods listed above.</p>
</dd>
</dl>


<h3>Note</h3>

<p>These methods and classes are part of the updated and modernized
<code>xcms</code> user interface which will eventually replace the
<code><a href="group-methods.html">group()</a></code> methods. All of the settings to the algorithm
can be passed with a <a href="groupChromPeaks-mzClust.html">MzClustParam</a> object.
</p>
<p>Calling <code>groupChromPeaks</code> on an <code>XCMSnExp</code> object will cause
all eventually present previous correspondence results to be dropped.
</p>


<h3>References</h3>

<p>Saira A. Kazmi, Samiran Ghosh, Dong-Guk Shin, Dennis W. Hill
and David F. Grant<br /> Alignment of high resolution mass spectra:
development of a heuristic approach for metabolomics.<br /> Metabolomics,
Vol. 2, No. 2, 75-83 (2006)
</p>


<h3>See Also</h3>

<p>The <code><a href="do_groupPeaks_mzClust.html">do_groupPeaks_mzClust()</a></code> core API function and <code><a href="group.mzClust.html">group.mzClust()</a></code> for
the old user interface.
</p>
<p><code><a href="XCMSnExp-class.html">featureDefinitions()</a></code> and <code><a href="XCMSnExp-peak-grouping-results.html">featureValues()</a></code> for methods to access peak
grouping results (i.e. the features).
</p>
<p><a href="XCMSnExp-class.html">XCMSnExp</a> for the object containing the results of
the peak grouping.
</p>
<p>Other peak grouping methods: <code><a href="groupChromPeaks-density.html">groupChromPeaks-density</a></code>,
<code><a href="groupChromPeaks-nearest.html">groupChromPeaks-nearest</a></code>,
<code><a href="groupChromPeaks.html">groupChromPeaks</a></code>
</p>


<h3>Examples</h3>

<pre>

## Loading a small subset of direct injection, single spectrum files
library(msdata)
fticrf &lt;- list.files(system.file("fticr", package = "msdata"),
                    recursive = TRUE, full.names = TRUE)
fticr &lt;- readMSData(fticrf[1:2], msLevel. = 1, mode = "onDisk")

## Perform the MSW peak detection on these:
p &lt;- MSWParam(scales = c(1, 7), peakThr = 80000, ampTh = 0.005,
             SNR.method = "data.mean", winSize.noise = 500)
fticr &lt;- findChromPeaks(fticr, param = p)

head(chromPeaks(fticr))

## Now create the MzClustParam parameter object: we're assuming here that
## both samples are from the same sample group.
p &lt;- MzClustParam(sampleGroups = c(1, 1))

fticr &lt;- groupChromPeaks(fticr, param = p)

## Get the definition of the features.
featureDefinitions(fticr)
</pre>

<hr /><div style="text-align: center;">[Package <em>xcms</em> version 3.8.1 <a href="00Index.html">Index</a>]</div>
</body></html>
