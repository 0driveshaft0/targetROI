<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Weighted version of the apply function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for wapply {multtest}"><tr><td>wapply {multtest}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Weighted version of the apply function</h2>

<h3>Description</h3>

<p>A function to perform 'apply' on an matrix of data and corresponding matrix of weights. 
</p>


<h3>Usage</h3>

<pre>
wapply(X, MARGIN, FUN, W = NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
<p>A matrix of data.</p>
</td></tr>
<tr valign="top"><td><code>MARGIN</code></td>
<td>
<p>A vector giving the subscripts which the function will be
applied over. 1 indicates rows, 2 indicates columns.</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>The function to be applied. In the case of functions like
<code>+</code> the function name must be quoted.</p>
</td></tr>
<tr valign="top"><td><code>W</code></td>
<td>
<p>An optional matrix of weights. When <code>W=NULL</code>, the usual <code>apply</code> function is called.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>optional arguments to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When weights are provided, these are passed to <code>FUN</code> along with the data <code>X</code>. For example, if <code>FUN=meanX</code>, each data value is multiplied by the corresponding weight before the mean is applied.
</p>


<h3>Value</h3>

<p>If each call to <code>FUN</code> returns a vector of length <code>n</code>, then <code>wapply</code> returns an array of dimension <code>c(n, dim(X)[MARGIN])</code> if <code>n &gt; 1</code>. If <code>n = 1</code>, <code>wapply</code> returns a vector if <code>MARGIN</code> has length 1 and an array of dimension <code>dim(X)[MARGIN]</code> otherwise. If <code>n = 0</code>, the result has length 0 but not necessarily the &quot;correct&quot; dimension.
</p>
<p>If the calls to <code>FUN</code> return vectors of different lengths, <code>wapply</code> returns a list of length <code>dim(X)[MARGIN]</code>.
</p>
<p>This function is used in the package <code>multtest</code> to compute weighted versions of test statistics. It is called by the function <code>get.Tn</code> inside the user-level function <code>MTP</code>.
</p>


<h3>Author(s)</h3>

<p>Katherine S. Pollard</p>


<h3>See Also</h3>

<p><code><a href="meanX.html">get.Tn</a></code>, <code><a href="MTP.html">MTP</a></code></p>


<h3>Examples</h3>

<pre>
data&lt;-matrix(rnorm(200),nr=20)
weights&lt;-matrix(rexp(200,rate=0.1),nr=20)
wapply(X=data,MARGIN=1,FUN=mean,W=weights)
</pre>

<hr /><div style="text-align: center;">[Package <em>multtest</em> version 2.40.0 <a href="00Index.html">Index</a>]</div>
</body></html>
