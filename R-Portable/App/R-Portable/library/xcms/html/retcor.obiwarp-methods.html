<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Align retention times across samples with Obiwarp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for retcor.obiwarp {xcms}"><tr><td>retcor.obiwarp {xcms}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Align retention times across samples with Obiwarp</h2>

<h3>Description</h3>

<p>Calculate retention time deviations for each sample.
It is based on the code at <a href="http://obi-warp.sourceforge.net/">http://obi-warp.sourceforge.net/</a>.
However, this function is able to align multiple samples, by a
center-star strategy.
</p>
<p>For the original publication see
</p>
<p>Chromatographic Alignment of ESI-LC-MS Proteomics Data Sets by
Ordered Bijective Interpolated Warping John T. Prince and, Edward
M. Marcotte Analytical Chemistry 2006 78 (17), 6140-6152
</p>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>the <code>xcmsSet</code> object</p>
</td></tr>
<tr valign="top"><td><code>plottype</code></td>
<td>
<p>if <code>deviation</code> plot retention time deviation</p>
</td></tr>
<tr valign="top"><td><code>profStep</code></td>
<td>
<p>step size (in m/z) to use for profile generation from
the raw data files</p>
</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
<p>the index of the sample all others will be aligned
to. If center==NULL, the sample with the most peaks is chosen as default.</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>vector of colors for plotting each sample</p>
</td></tr>
<tr valign="top"><td><code>ty</code></td>
<td>
<p>vector of line and point types for plotting each sample</p>
</td></tr>
<tr valign="top"><td><code>response</code></td>
<td>
<p>Responsiveness of warping.  0 will give a linear warp based
on start and end points.  100 will use all bijective anchors</p>
</td></tr>
<tr valign="top"><td><code>distFunc</code></td>
<td>
<p>DistFunc function: cor (Pearson's R) or cor_opt (default,
calculate only 10% diagonal band of distance matrix, better
runtime), cov (covariance), prd (product), euc (Euclidean distance)</p>
</td></tr>
<tr valign="top"><td><code>gapInit</code></td>
<td>
<p>Penalty for Gap opening, see below</p>
</td></tr>
<tr valign="top"><td><code>gapExtend</code></td>
<td>
<p>Penalty for Gap enlargement, see below</p>
</td></tr>
<tr valign="top"><td><code>factorDiag</code></td>
<td>
<p>Local weighting applied to diagonal moves in alignment.</p>
</td></tr>
<tr valign="top"><td><code>factorGap</code></td>
<td>
<p>Local weighting applied to gap moves in alignment.</p>
</td></tr>
<tr valign="top"><td><code>localAlignment</code></td>
<td>
<p>Local rather than global alignment</p>
</td></tr>
<tr valign="top"><td><code>initPenalty</code></td>
<td>
<p>Penalty for initiating alignment (for local
alignment only) Default: 0</p>
</td></tr>
</table>
<p>Default gap penalties: (gapInit, gapExtend) [by distFunc type]:
'cor' = '0.3,2.4'
'cov' = '0,11.7'
'prd' = '0,7.8'
'euc' = '0.9,1.8'
</p>


<h3>Value</h3>

<p>An <code>xcmsSet</code> object
</p>


<h3>Methods</h3>


<dl>
<dt>object = &quot;xcmsSet&quot;</dt><dd>
<p>retcor(object, method=&quot;obiwarp&quot;, plottype = c(&quot;none&quot;, &quot;deviation&quot;),
profStep=1, center=NULL, col = NULL, ty = NULL,
response=1, distFunc=&quot;cor_opt&quot;, gapInit=NULL, gapExtend=NULL,
factorDiag=2, factorGap=1, localAlignment=0, initPenalty=0)
</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="xcmsSet-class.html">xcmsSet-class</a></code>,
</p>

<hr /><div style="text-align: center;">[Package <em>xcms</em> version 3.0.2 <a href="00Index.html">Index</a>]</div>
</body></html>
